<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Carrito de Compras</title>
  <link rel="stylesheet" href="hojaestilos.css">
  <link rel="icon" href="pinkjewel.png">
</head>
<body>

<div class="carrito-wrapper">
  <div id="carrito-container">
    <h2>游 Carrito de Compras</h2>
    <ul id="lista-carrito"></ul>
    <div id="total-container">
      <h3>Total: $<span id="total">0</span></h3>
    </div>
    <button class="boton-carrito" id="vaciar-carrito" onclick="vaciarCarrito()">Vaciar carrito</button>
    <button class="boton-carrito" id="realizar-compra" onclick="realizarCompra()">Realizar compra</button>
  </div>
</div>

<div id="modal-pago" class="modal">
  <div class="modal-contenido">
    <span class="cerrar" onclick="cerrarModal()">&times;</span>
    <h2>Informaci칩n de Pago</h2>
    <form id="formulario-pago" onsubmit="procesarPago(event)">
      <label>Nombre en la tarjeta:</label>
      <input type="text" id="nombre" required>

      <label>N칰mero de tarjeta:</label>
      <input type="text" id="tarjeta" required pattern="\d{16}" placeholder="16 d칤gitos">

      <label>Fecha de vencimiento:</label>
      <input type="month" id="vencimiento" required>

      <label>CVV:</label>
      <input type="text" id="cvv" required pattern="\d{3}" placeholder="3 d칤gitos">

      <label>Direcci칩n:</label>
<input type="text" id="direccion" required placeholder="Calle, n칰mero, piso, etc.">

<label>Ciudad:</label>
<input type="text" id="ciudad" required>

<label>C칩digo postal:</label>
<input type="text" id="codigo-postal" required pattern="\d{4,10}" placeholder="Ej. 12345">


      <button type="submit" class="boton-carrito">Confirmar compra</button>
    </form>
  </div>
</div>
<a href="index.html" class="regresar2">Regresar</a>

<footer class="footer2">
  <p>&copy; 2025 Blue Jewel. Todos los derechos reservados.</p>
</footer>

<script>
  const listaCarrito = document.getElementById('lista-carrito');
  const totalElemento = document.getElementById('total');
  let total = 0;

  const productosEnCarrito = JSON.parse(localStorage.getItem('carrito')) || [];
  productosEnCarrito.forEach(producto => agregarAlCarrito(producto));

  function agregarAlCarrito(producto) {
    const item = document.createElement('li');
    item.textContent = `${producto.nombre} - $${producto.precio}`;
    const botonEliminar = document.createElement('button');
    botonEliminar.textContent = 'X';
    botonEliminar.classList.add('eliminar-btn');
    botonEliminar.onclick = function () {
      item.remove();
      eliminarDelLocalStorage(producto);
    };
    item.appendChild(botonEliminar);
    listaCarrito.appendChild(item);
    actualizarTotal(producto.precio);
  }

  function actualizarTotal(precio) {
    total += precio;
    totalElemento.textContent = total.toFixed(2);
  }

  function eliminarDelLocalStorage(producto) {
    let carrito = JSON.parse(localStorage.getItem('carrito')) || [];
    const index = carrito.findIndex(item => item.nombre === producto.nombre && item.precio === producto.precio);
    if (index !== -1) {
      carrito.splice(index, 1);
      localStorage.setItem('carrito', JSON.stringify(carrito));
      total -= producto.precio;
      totalElemento.textContent = total.toFixed(2);
    }
  }

  function vaciarCarrito() {
    listaCarrito.innerHTML = '';
    total = 0;
    totalElemento.textContent = total.toFixed(2);
    localStorage.removeItem('carrito');
  }

  function realizarCompra() {
    if (listaCarrito.children.length === 0) {
      alert("El carrito est치 vac칤o. Agrega productos antes de comprar.");
      return;
    }
    document.getElementById("modal-pago").style.display = "block";
  }

  function cerrarModal() {
    document.getElementById("modal-pago").style.display = "none";
  }

  function procesarPago(event) {
    event.preventDefault();
    alert(`춰Compra realizada exitosamente! 游눱游눑 Total: $${total.toFixed(2)}`);
    cerrarModal();
    vaciarCarrito();
  }
</script>

</body>
</html>
